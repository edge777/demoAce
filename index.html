<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AceCoin Demo Platform - Professional Crypto Spot Trading</title>
    <link rel="stylesheet" href="css/main.css">
  </head>
<body class="min-h-screen overflow-x-hidden bg-zinc-950 text-white antialiased">
    
    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 border-b border-zinc-800 bg-zinc-950">
        <div class="max-w-full px-3 md:px-4 py-2 md:py-2.5 flex items-center justify-between">
            <button id="mobile-pairs-btn" class="lg:hidden p-1.5 border border-zinc-800 rounded hover:bg-zinc-900 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
            </button>
            
            <a href="#" class="flex items-center gap-2">
                <img src="assets/images/IMG_20260115_133429_460-1768464368957.jpg" alt="AceCoin logo" class="h-7 w-7 md:h-8 md:w-8 object-cover rounded">
                <span class="text-xs md:text-sm font-semibold tracking-tight">AsiaCoin</span>
            </a>
            
            <div class="hidden md:flex items-center gap-6 text-xs font-medium">
                <a href="#" class="text-zinc-400 hover:text-white transition-colors">Trade</a>
                <a href="#" class="text-zinc-400 hover:text-white transition-colors">Markets</a>
                <a href="#" class="text-zinc-400 hover:text-white transition-colors">Portfolio</a>
                <a href="#" class="text-zinc-400 hover:text-white transition-colors">Leaderboard</a>
                <button class="px-4 py-1.5 bg-emerald-500 hover:bg-emerald-600 text-black text-xs font-semibold rounded transition-all">
                    Connect Wallet
                </button>
            </div>

            <button id="mobile-menu-btn" class="md:hidden p-1.5 border border-zinc-800 rounded">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M4 6h16M4 12h16M4 18h16"></path>
                </svg>
            </button>
        </div>

        <div id="mobile-menu" class="hidden md:hidden border-t border-zinc-800 bg-zinc-950">
            <div class="px-4 py-3 space-y-2">
                <a href="#" class="block text-zinc-400 hover:text-white transition-colors text-sm">Trade</a>
                <a href="#" class="block text-zinc-400 hover:text-white transition-colors text-sm">Markets</a>
                <a href="#" class="block text-zinc-400 hover:text-white transition-colors text-sm">Portfolio</a>
                <a href="#" class="block text-zinc-400 hover:text-white transition-colors text-sm">Leaderboard</a>
                <button class="w-full px-4 py-2 bg-emerald-500 hover:bg-emerald-600 text-black text-sm font-semibold rounded transition-all">
                    Connect Wallet
                </button>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
<section class="min-h-screen pt-12 md:pt-14 pb-14 md:pb-0 bg-zinc-950">
    <div class="h-[calc(100vh-3rem)] md:h-[calc(100vh-3.5rem)] flex flex-col">
        
        <!-- Mobile Trading Pairs Drawer Overlay -->
        <div id="mobile-pairs-overlay" class="fixed inset-0 bg-black/60 z-40 hidden lg:hidden">
            <div id="mobile-pairs-drawer" class="absolute left-0 top-0 bottom-0 w-80 max-w-[85vw] bg-zinc-950 border-r border-zinc-800 transform -translate-x-full transition-transform duration-300">
                <!-- Drawer Header -->
                <div class="px-4 py-3 border-b border-zinc-800 flex items-center justify-between">
                    <h3 class="text-sm font-semibold">Markets</h3>
                    <button id="close-pairs-drawer" class="p-1.5 hover:bg-zinc-900 rounded transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M18 6L6 18M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>

                <!-- Search Bar -->
                <div class="px-4 py-3 border-b border-zinc-800">
                    <div class="relative mb-3">
                        <input 
                            type="text" 
                            id="mobile-market-search" 
                            placeholder="Search pairs..." 
                            class="w-full bg-zinc-900 border border-zinc-800 rounded px-3 py-2 text-sm outline-none focus:border-emerald-500 transition-colors pl-9"
                        >
                        <svg class="absolute left-3 top-2.5 w-4 h-4 text-zinc-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                    </div>

                    <!-- Filter Tabs -->
                    <div class="flex gap-2">
                        <button class="mobile-market-filter-btn flex-1 px-3 py-1.5 text-xs font-semibold bg-emerald-500/10 text-emerald-400 border border-emerald-500/30 rounded" data-filter="all">
                            All
                        </button>
                        <button class="mobile-market-filter-btn flex-1 px-3 py-1.5 text-xs font-semibold text-zinc-500 border border-zinc-800 rounded hover:bg-zinc-900 transition-colors" data-filter="favorites">
                            ‚≠ê Fav
                        </button>
                        <button class="mobile-market-filter-btn flex-1 px-3 py-1.5 text-xs font-semibold text-zinc-500 border border-zinc-800 rounded hover:bg-zinc-900 transition-colors" data-filter="gainers">
                            üî• Top
                        </button>
                    </div>
                </div>

                <!-- Trading Pairs List -->
                <div class="flex-1 overflow-y-auto">
                    <!-- Column Headers -->
                    <div class="sticky top-0 bg-zinc-950 px-4 py-2 border-b border-zinc-800 flex items-center justify-between text-xs text-zinc-500 font-semibold">
                        <span>Pair</span>
                        <span>Price</span>
                        <span>24h %</span>
                    </div>

                    <!-- Trading Pairs -->
                    <div id="mobile-trading-pairs-list" class="divide-y divide-zinc-900">
                        <!-- Pairs will be dynamically inserted here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Trading Platform Layout -->
        <div class="flex-1 grid grid-cols-1 lg:grid-cols-12 border-t border-zinc-800">
            
            <!-- LEFT SIDEBAR: Trading Pairs (Desktop Only) -->
            <div class="hidden lg:flex lg:col-span-2 flex-col border-r border-zinc-800 bg-zinc-950">
                <!-- Sidebar Header -->
                <div class="px-3 py-3 border-b border-zinc-800">
                    <h3 class="text-xs font-semibold mb-3">Markets</h3>
                    
                    <!-- Search Bar -->
                    <div class="relative mb-3">
                        <input 
                            type="text" 
                            id="market-search" 
                            placeholder="Search pairs..." 
                            class="w-full bg-zinc-900 border border-zinc-800 rounded px-3 py-1.5 text-xs outline-none focus:border-emerald-500 transition-colors pl-8"
                        >
                        <svg class="absolute left-2.5 top-2 w-3.5 h-3.5 text-zinc-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                    </div>

                    <!-- Filter Tabs -->
                    <div class="flex gap-1">
                        <button class="market-filter-btn flex-1 px-2 py-1 text-[10px] font-semibold bg-emerald-500/10 text-emerald-400 border border-emerald-500/30 rounded" data-filter="all">
                            All
                        </button>
                        <button class="market-filter-btn flex-1 px-2 py-1 text-[10px] font-semibold text-zinc-500 border border-zinc-800 rounded hover:bg-zinc-900 transition-colors" data-filter="favorites">
                            ‚≠ê Fav
                        </button>
                        <button class="market-filter-btn flex-1 px-2 py-1 text-[10px] font-semibold text-zinc-500 border border-zinc-800 rounded hover:bg-zinc-900 transition-colors" data-filter="gainers">
                            üî• Top
                        </button>
                    </div>
                </div>

                <!-- Trading Pairs List -->
                <div class="flex-1 overflow-y-auto">
                    <!-- Column Headers -->
                    <div class="sticky top-0 bg-zinc-950 px-3 py-2 border-b border-zinc-800 flex items-center justify-between text-[10px] text-zinc-500 font-semibold">
                        <span>Pair</span>
                        <span>Price</span>
                        <span>24h %</span>
                    </div>

                    <!-- Trading Pairs -->
                    <div id="trading-pairs-list" class="divide-y divide-zinc-900">
                        <!-- Pairs will be dynamically inserted here -->
                    </div>
                </div>
            </div>

            <!-- CENTER & RIGHT: Main Content Area -->
            <div class="lg:col-span-10 flex flex-col">
                
                <!-- Market Header -->
                <div class="border-b border-zinc-800 px-3 md:px-4 py-2 md:py-3">
                    <div class="flex items-center justify-between mb-2 md:mb-0">
                        <div class="flex items-center gap-3 md:gap-6 flex-1 min-w-0">
                            <div class="min-w-0">
                                <div class="flex items-center gap-2">
                                    <h3 id="active-pair-name" class="text-sm md:text-lg font-bold truncate">BTC/USDT</h3>
                                    <span class="text-[10px] md:text-xs text-zinc-500">Spot</span>
                                </div>
                                <div class="flex items-baseline gap-1 md:gap-2 mt-0.5">
                                    <span id="current-price" class="text-base md:text-xl font-bold text-emerald-400">$43,821.50</span>
                                    <span id="price-change" class="text-emerald-400 text-[10px] md:text-xs">+$1,234.50</span>
                                    <span id="price-change-percent" class="text-emerald-400 text-[10px] md:text-xs">+2.34%</span>
                                </div>
                            </div>
                            
                            <div class="hidden md:flex items-center gap-6 text-xs">
                                <div>
                                    <div class="text-zinc-500">24h High</div>
                                    <div id="high-24h" class="font-semibold">$44,125.00</div>
                                </div>
                                <div>
                                    <div class="text-zinc-500">24h Low</div>
                                    <div id="low-24h" class="font-semibold">$42,890.00</div>
                                </div>
                                <div>
                                    <div class="text-zinc-500">24h Volume</div>
                                    <div id="volume-24h" class="font-semibold">$2.4B</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="hidden md:flex items-center gap-2">
                            <button class="timeframe-btn px-3 py-1 text-xs border border-zinc-800 rounded hover:bg-zinc-900 transition-colors" data-timeframe="1m">1m</button>
                            <button class="timeframe-btn px-3 py-1 text-xs border border-zinc-800 rounded hover:bg-zinc-900 transition-colors" data-timeframe="5m">5m</button>
                            <button class="timeframe-btn px-3 py-1 text-xs border border-emerald-500 bg-emerald-500/10 text-emerald-400 rounded active" data-timeframe="1h">1h</button>
                            <button class="timeframe-btn px-3 py-1 text-xs border border-zinc-800 rounded hover:bg-zinc-900 transition-colors" data-timeframe="4h">4h</button>
                            <button class="timeframe-btn px-3 py-1 text-xs border border-zinc-800 rounded hover:bg-zinc-900 transition-colors" data-timeframe="1D">1D</button>
                        </div>
                    </div>

                    <!-- Mobile 24h Stats -->
                    <div class="flex md:hidden items-center gap-4 text-[10px] mt-2">
                        <div>
                            <span class="text-zinc-500">High:</span>
                            <span id="mobile-high-24h" class="font-semibold ml-1">$44,125.00</span>
                        </div>
                        <div>
                            <span class="text-zinc-500">Low:</span>
                            <span id="mobile-low-24h" class="font-semibold ml-1">$42,890.00</span>
                        </div>
                        <div>
                            <span class="text-zinc-500">Vol:</span>
                            <span id="mobile-volume-24h" class="font-semibold ml-1">$2.4B</span>
                        </div>
                    </div>

                    <!-- Mobile Timeframe Selector -->
                    <div class="flex md:hidden items-center gap-1 mt-2 overflow-x-auto pb-1">
                        <button class="mobile-timeframe-btn flex-shrink-0 px-3 py-1 text-[10px] border border-zinc-800 rounded hover:bg-zinc-900 transition-colors" data-timeframe="1m">1m</button>
                        <button class="mobile-timeframe-btn flex-shrink-0 px-3 py-1 text-[10px] border border-zinc-800 rounded hover:bg-zinc-900 transition-colors" data-timeframe="5m">5m</button>
                        <button class="mobile-timeframe-btn flex-shrink-0 px-3 py-1 text-[10px] border border-emerald-500 bg-emerald-500/10 text-emerald-400 rounded active" data-timeframe="1h">1h</button>
                        <button class="mobile-timeframe-btn flex-shrink-0 px-3 py-1 text-[10px] border border-zinc-800 rounded hover:bg-zinc-900 transition-colors" data-timeframe="4h">4h</button>
                        <button class="mobile-timeframe-btn flex-shrink-0 px-3 py-1 text-[10px] border border-zinc-800 rounded hover:bg-zinc-900 transition-colors" data-timeframe="1D">1D</button>
                    </div>
                </div>

                <!-- Content Area with Mobile Tabs -->
                <div class="flex-1 flex flex-col overflow-hidden">
                    
                    <!-- Chart Panel (Always Visible on Desktop, Switchable on Mobile) -->
                    <div id="chart-panel" class="flex-1 flex flex-col lg:grid lg:grid-cols-10">
                        
                        <!-- Chart Section -->
                        <div class="lg:col-span-7 flex-1 flex flex-col lg:border-r border-zinc-800">
                            <!-- Chart Area -->
                            <div class="flex-1 bg-zinc-950 relative">
                                <canvas id="trading-chart" class="w-full h-full"></canvas>
                                <div id="chart-tooltip" class="absolute hidden bg-zinc-900 border border-zinc-800 rounded px-3 py-2 text-xs pointer-events-none z-10">
                                    <div class="space-y-1">
                                        <div class="font-semibold text-zinc-300">Time: <span id="tooltip-time"></span></div>
                                        <div class="text-emerald-400">O: <span id="tooltip-open"></span></div>
                                        <div class="text-blue-400">H: <span id="tooltip-high"></span></div>
                                        <div class="text-red-400">L: <span id="tooltip-low"></span></div>
                                        <div class="text-zinc-100">C: <span id="tooltip-close"></span></div>
                                        <div class="text-zinc-400">Vol: <span id="tooltip-volume"></span></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Bottom Trading Panel (Desktop Only) -->
                            <div class="hidden lg:block border-t border-zinc-800 bg-zinc-950">
                                <div class="flex items-center gap-2 px-4 py-2 border-b border-zinc-800">
                                    <button class="px-3 py-1.5 text-xs font-medium text-white bg-zinc-900 rounded">Open Orders (0)</button>
                                    <button class="px-3 py-1.5 text-xs font-medium text-zinc-500 hover:text-white transition-colors">Order History</button>
                                    <button class="px-3 py-1.5 text-xs font-medium text-zinc-500 hover:text-white transition-colors">Trade History</button>
                                </div>
                                <div class="px-4 py-8 text-center text-zinc-600 text-sm">
                                    No open orders
                                </div>
                            </div>
                        </div>

                        <!-- Order Book Section (Desktop) / Hidden on Mobile -->
                        <div class="hidden lg:flex lg:col-span-3 flex-col bg-zinc-950">
                            <div class="flex-1 flex flex-col overflow-hidden">
                                <div class="px-3 py-2 border-b border-zinc-800">
                                    <h3 class="text-xs font-semibold">Order Book</h3>
                                </div>
                                
                                <div class="flex-1 overflow-y-auto">
                                    <!-- Sell Orders -->
                                    <div class="px-3 py-2">
                                        <div class="text-[10px] text-zinc-500 mb-2 flex justify-between">
                                            <span>Price(USDT)</span>
                                            <span>Amount</span>
                                        </div>
                                        <div class="space-y-0.5 font-mono text-[11px]" id="desktop-sell-orders">
                                            <!-- Sell orders will be inserted here -->
                                        </div>
                                    </div>

                                    <!-- Current Price -->
                                    <div class="px-3 py-2 bg-emerald-500/5 border-y border-emerald-500/20">
                                        <div class="flex items-center justify-between">
                                            <span class="text-base font-bold text-emerald-400">43,821.50</span>
                                            <span class="text-[10px] text-emerald-400">‚Üë $125.30</span>
                                        </div>
                                    </div>

                                    <!-- Buy Orders -->
                                    <div class="px-3 py-2">
                                        <div class="space-y-0.5 font-mono text-[11px]" id="desktop-buy-orders">
                                            <!-- Buy orders will be inserted here -->
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Trading Panel (Desktop) -->
                            <div class="border-t border-zinc-800 p-3">
                                <div class="flex gap-1 mb-3">
                                    <button class="flex-1 py-1.5 text-xs font-semibold bg-emerald-500/10 text-emerald-400 border border-emerald-500/30 rounded">Buy</button>
                                    <button class="flex-1 py-1.5 text-xs font-semibold text-zinc-500 hover:text-white border border-zinc-800 rounded transition-colors">Sell</button>
                                </div>

                                <div class="space-y-2">
                                    <div>
                                        <label class="text-[10px] text-zinc-500 mb-1 block">Price</label>
                                        <div class="bg-zinc-900 border border-zinc-800 rounded px-2 py-1.5">
                                            <input type="text" placeholder="Market" class="bg-transparent w-full outline-none font-mono text-xs">
                                        </div>
                                    </div>

                                    <div>
                                        <label class="text-[10px] text-zinc-500 mb-1 block">Amount</label>
                                        <div class="bg-zinc-900 border border-zinc-800 rounded px-2 py-1.5">
                                            <input type="text" placeholder="0.00" class="bg-transparent w-full outline-none font-mono text-xs">
                                        </div>
                                    </div>

                                    <button class="w-full py-2 bg-emerald-500 hover:bg-emerald-600 text-black text-xs font-bold rounded transition-all">
                                        Buy BTC
                                    </button>
                                </div>

                                <div class="mt-3 pt-3 border-t border-zinc-800 text-[10px] text-zinc-500 space-y-1">
                                    <div class="flex justify-between">
                                        <span>Available</span>
                                        <span class="text-white font-semibold">0.00 USDT</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Max Buy</span>
                                        <span class="text-white font-semibold">0.00 BTC</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Order Book Panel (Mobile Only) -->
                    <div id="orderbook-panel" class="hidden flex-1 flex-col overflow-hidden bg-zinc-950 lg:hidden">
                        <div class="px-3 py-3 border-b border-zinc-800">
                            <h3 class="text-sm font-semibold">Order Book</h3>
                        </div>
                        
                        <div class="flex-1 overflow-y-auto">
                            <!-- Sell Orders -->
                            <div class="px-3 py-2">
                                <div class="text-xs text-zinc-500 mb-2 flex justify-between font-semibold">
                                    <span>Price(USDT)</span>
                                    <span>Amount</span>
                                </div>
                                <div class="space-y-1 font-mono text-sm" id="mobile-sell-orders">
                                    <!-- Sell orders will be inserted here -->
                                </div>
                            </div>

                            <!-- Current Price -->
                            <div class="px-3 py-3 bg-emerald-500/5 border-y border-emerald-500/20 my-2">
                                <div class="flex items-center justify-between">
                                    <span class="text-lg font-bold text-emerald-400">43,821.50</span>
                                    <span class="text-xs text-emerald-400">‚Üë $125.30</span>
                                </div>
                            </div>

                            <!-- Buy Orders -->
                            <div class="px-3 py-2">
                                <div class="space-y-1 font-mono text-sm" id="mobile-buy-orders">
                                    <!-- Buy orders will be inserted here -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Trade Panel (Mobile Only) -->
                    <div id="trade-panel" class="hidden flex-1 flex-col overflow-y-auto bg-zinc-950 lg:hidden">
                        <div class="p-4">
                            <h3 class="text-sm font-semibold mb-4">Place Order</h3>
                            
                            <div class="flex gap-2 mb-4">
                                <button class="flex-1 py-2.5 text-sm font-semibold bg-emerald-500/10 text-emerald-400 border border-emerald-500/30 rounded-lg">Buy</button>
                                <button class="flex-1 py-2.5 text-sm font-semibold text-zinc-500 hover:text-white border border-zinc-800 rounded-lg transition-colors">Sell</button>
                            </div>

                            <div class="space-y-3">
                                <div>
                                    <label class="text-xs text-zinc-500 mb-2 block">Price</label>
                                    <div class="bg-zinc-900 border border-zinc-800 rounded-lg px-3 py-3">
                                        <input type="text" placeholder="Market" class="bg-transparent w-full outline-none font-mono text-sm">
                                    </div>
                                </div>

                                <div>
                                    <label class="text-xs text-zinc-500 mb-2 block">Amount</label>
                                    <div class="bg-zinc-900 border border-zinc-800 rounded-lg px-3 py-3">
                                        <input type="text" placeholder="0.00" class="bg-transparent w-full outline-none font-mono text-sm">
                                    </div>
                                </div>

                                <button class="w-full py-3 bg-emerald-500 hover:bg-emerald-600 text-black text-sm font-bold rounded-lg transition-all">
                                    Buy BTC
                                </button>
                            </div>

                            <div class="mt-4 pt-4 border-t border-zinc-800 text-xs text-zinc-500 space-y-2">
                                <div class="flex justify-between">
                                    <span>Available</span>
                                    <span class="text-white font-semibold">0.00 USDT</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Max Buy</span>
                                    <span class="text-white font-semibold">0.00 BTC</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Mobile Bottom Navigation -->
                    <div class="lg:hidden border-t border-zinc-800 bg-zinc-950 safe-area-inset-bottom">
                        <div class="grid grid-cols-3 divide-x divide-zinc-800">
                            <button class="mobile-tab-btn py-3 text-xs font-semibold text-emerald-400 bg-emerald-500/5 transition-colors" data-tab="chart">
                                <div class="flex flex-col items-center gap-1">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                                    </svg>
                                    <span>Chart</span>
                                </div>
                            </button>
                            <button class="mobile-tab-btn py-3 text-xs font-semibold text-zinc-500 hover:text-white transition-colors" data-tab="orderbook">
                                <div class="flex flex-col items-center gap-1">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <line x1="8" y1="6" x2="21" y2="6"></line>
                                        <line x1="8" y1="12" x2="21" y2="12"></line>
                                        <line x1="8" y1="18" x2="21" y2="18"></line>
                                        <line x1="3" y1="6" x2="3.01" y2="6"></line>
                                        <line x1="3" y1="12" x2="3.01" y2="12"></line>
                                        <line x1="3" y1="18" x2="3.01" y2="18"></line>
                                    </svg>
                                    <span>Orders</span>
                                </div>
                            </button>
                            <button class="mobile-tab-btn py-3 text-xs font-semibold text-zinc-500 hover:text-white transition-colors" data-tab="trade">
                                <div class="flex flex-col items-center gap-1">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <line x1="12" y1="5" x2="12" y2="19"></line>
                                        <line x1="5" y1="12" x2="19" y2="12"></line>
                                    </svg>
                                    <span>Trade</span>
                                </div>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

    <!-- Main JavaScript -->
    <script>
        // Order Book Data
        const orderBookData = {
            sellOrders: [
                { price: 43828.00, amount: 0.234 },
                { price: 43827.50, amount: 0.567 },
                { price: 43827.00, amount: 1.123 },
                { price: 43826.50, amount: 0.891 },
                { price: 43826.00, amount: 2.345 },
                { price: 43825.50, amount: 0.678 },
                { price: 43825.00, amount: 1.456 },
                { price: 43824.50, amount: 0.234 },
                { price: 43824.00, amount: 3.567 }
            ],
            buyOrders: [
                { price: 43821.00, amount: 1.234 },
                { price: 43820.50, amount: 2.567 },
                { price: 43820.00, amount: 0.891 },
                { price: 43819.50, amount: 1.456 },
                { price: 43819.00, amount: 3.234 },
                { price: 43818.50, amount: 0.678 },
                { price: 43818.00, amount: 2.789 },
                { price: 43817.50, amount: 1.123 },
                { price: 43817.00, amount: 0.456 }
            ]
        };

        // Render Order Book
        function renderOrderBook() {
            // Desktop Sell Orders
            const desktopSellContainer = document.getElementById('desktop-sell-orders');
            if (desktopSellContainer) {
                desktopSellContainer.innerHTML = orderBookData.sellOrders.map(order => `
                    <div class="flex justify-between text-red-400 hover:bg-red-500/5 px-1 py-0.5 rounded cursor-pointer">
                        <span>${order.price.toLocaleString()}</span>
                        <span>${order.amount.toFixed(3)}</span>
                    </div>
                `).join('');
            }

            // Desktop Buy Orders
            const desktopBuyContainer = document.getElementById('desktop-buy-orders');
            if (desktopBuyContainer) {
                desktopBuyContainer.innerHTML = orderBookData.buyOrders.map(order => `
                    <div class="flex justify-between text-emerald-400 hover:bg-emerald-500/5 px-1 py-0.5 rounded cursor-pointer">
                        <span>${order.price.toLocaleString()}</span>
                        <span>${order.amount.toFixed(3)}</span>
                    </div>
                `).join('');
            }

            // Mobile Sell Orders
            const mobileSellContainer = document.getElementById('mobile-sell-orders');
            if (mobileSellContainer) {
                mobileSellContainer.innerHTML = orderBookData.sellOrders.map(order => `
                    <div class="flex justify-between text-red-400 hover:bg-red-500/5 px-2 py-1.5 rounded cursor-pointer active:bg-red-500/10">
                        <span>${order.price.toLocaleString()}</span>
                        <span>${order.amount.toFixed(3)}</span>
                    </div>
                `).join('');
            }

            // Mobile Buy Orders
            const mobileBuyContainer = document.getElementById('mobile-buy-orders');
            if (mobileBuyContainer) {
                mobileBuyContainer.innerHTML = orderBookData.buyOrders.map(order => `
                    <div class="flex justify-between text-emerald-400 hover:bg-emerald-500/5 px-2 py-1.5 rounded cursor-pointer active:bg-emerald-500/10">
                        <span>${order.price.toLocaleString()}</span>
                        <span>${order.amount.toFixed(3)}</span>
                    </div>
                `).join('');
            }
        }

        // Mobile Tab Navigation
        function initMobileTabs() {
            const chartPanel = document.getElementById('chart-panel');
            const orderbookPanel = document.getElementById('orderbook-panel');
            const tradePanel = document.getElementById('trade-panel');
            const tabButtons = document.querySelectorAll('.mobile-tab-btn');

            tabButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const tab = btn.dataset.tab;

                    // Update button styles
                    tabButtons.forEach(b => {
                        b.classList.remove('text-emerald-400', 'bg-emerald-500/5');
                        b.classList.add('text-zinc-500');
                    });
                    btn.classList.remove('text-zinc-500');
                    btn.classList.add('text-emerald-400', 'bg-emerald-500/5');

                    // Show corresponding panel
                    chartPanel.classList.add('hidden');
                    orderbookPanel.classList.add('hidden');
                    tradePanel.classList.add('hidden');

                    if (tab === 'chart') {
                        chartPanel.classList.remove('hidden');
                        chartPanel.classList.add('flex');
                    } else if (tab === 'orderbook') {
                        orderbookPanel.classList.remove('hidden');
                        orderbookPanel.classList.add('flex');
                    } else if (tab === 'trade') {
                        tradePanel.classList.remove('hidden');
                        tradePanel.classList.add('flex');
                    }
                });
            });
        }

        // Mobile Pairs Drawer
        function initMobilePairsDrawer() {
            const mobilePairsBtn = document.getElementById('mobile-pairs-btn');
            const mobilePairsOverlay = document.getElementById('mobile-pairs-overlay');
            const mobilePairsDrawer = document.getElementById('mobile-pairs-drawer');
            const closePairsDrawer = document.getElementById('close-pairs-drawer');

            if (mobilePairsBtn && mobilePairsOverlay && mobilePairsDrawer) {
                mobilePairsBtn.addEventListener('click', () => {
                    mobilePairsOverlay.classList.remove('hidden');
                    setTimeout(() => {
                        mobilePairsDrawer.classList.remove('-translate-x-full');
                    }, 10);
                });

                closePairsDrawer.addEventListener('click', () => {
                    mobilePairsDrawer.classList.add('-translate-x-full');
                    setTimeout(() => {
                        mobilePairsOverlay.classList.add('hidden');
                    }, 300);
                });

                mobilePairsOverlay.addEventListener('click', (e) => {
                    if (e.target === mobilePairsOverlay) {
                        mobilePairsDrawer.classList.add('-translate-x-full');
                        setTimeout(() => {
                            mobilePairsOverlay.classList.add('hidden');
                        }, 300);
                    }
                });
            }
        }

        // Mobile menu toggle
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        
        if (mobileMenuBtn && mobileMenu) {
            mobileMenuBtn.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });
        }

        // Trading Pairs Data
        const tradingPairs = [
            { symbol: 'BTC/USDT', name: 'Bitcoin', price: 43821.50, change24h: 2.34, volume: 2400000000, isFavorite: false },
            { symbol: 'ETH/USDT', name: 'Ethereum', price: 2284.75, change24h: 3.67, volume: 1800000000, isFavorite: false },
            { symbol: 'SOL/USDT', name: 'Solana', price: 98.42, change24h: 8.92, volume: 890000000, isFavorite: false },
            { symbol: 'AVAX/USDT', name: 'Avalanche', price: 36.87, change24h: -1.23, volume: 450000000, isFavorite: false },
            { symbol: 'MATIC/USDT', name: 'Polygon', price: 0.89, change24h: 4.56, volume: 320000000, isFavorite: false },
            { symbol: 'ARB/USDT', name: 'Arbitrum', price: 1.42, change24h: 6.78, volume: 280000000, isFavorite: false },
            { symbol: 'OP/USDT', name: 'Optimism', price: 2.34, change24h: -2.45, volume: 190000000, isFavorite: false },
            { symbol: 'LINK/USDT', name: 'Chainlink', price: 14.67, change24h: 1.89, volume: 410000000, isFavorite: false },
            { symbol: 'UNI/USDT', name: 'Uniswap', price: 6.23, change24h: 3.21, volume: 220000000, isFavorite: false },
            { symbol: 'AAVE/USDT', name: 'Aave', price: 89.45, change24h: -0.87, volume: 150000000, isFavorite: false },
            { symbol: 'DOGE/USDT', name: 'Dogecoin', price: 0.082, change24h: 5.43, volume: 560000000, isFavorite: false },
            { symbol: 'XRP/USDT', name: 'Ripple', price: 0.58, change24h: 2.11, volume: 890000000, isFavorite: false },
            { symbol: 'ADA/USDT', name: 'Cardano', price: 0.42, change24h: -1.56, volume: 340000000, isFavorite: false },
            { symbol: 'DOT/USDT', name: 'Polkadot', price: 6.78, change24h: 1.23, volume: 270000000, isFavorite: false },
            { symbol: 'ATOM/USDT', name: 'Cosmos', price: 10.45, change24h: 4.67, volume: 180000000, isFavorite: false }
        ];

        // Trading Pairs Manager
        class TradingPairsManager {
            constructor() {
                this.pairs = tradingPairs;
                this.currentFilter = 'all';
                this.searchQuery = '';
                this.activePair = 'BTC/USDT';
                
                this.init();
            }

            init() {
                this.renderPairs();
                this.renderMobilePairs();
                this.setupEventListeners();
                this.loadFavorites();
            }

            setupEventListeners() {
                // Desktop Search functionality
                const searchInput = document.getElementById('market-search');
                if (searchInput) {
                    searchInput.addEventListener('input', (e) => {
                        this.searchQuery = e.target.value.toLowerCase();
                        this.renderPairs();
                    });
                }

                // Mobile Search functionality
                const mobileSearchInput = document.getElementById('mobile-market-search');
                if (mobileSearchInput) {
                    mobileSearchInput.addEventListener('input', (e) => {
                        this.searchQuery = e.target.value.toLowerCase();
                        this.renderMobilePairs();
                    });
                }

                // Desktop Filter buttons
                document.querySelectorAll('.market-filter-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.currentFilter = e.target.dataset.filter;
                        
                        // Update button styles
                        document.querySelectorAll('.market-filter-btn').forEach(b => {
                            b.classList.remove('bg-emerald-500/10', 'text-emerald-400', 'border-emerald-500/30');
                            b.classList.add('text-zinc-500', 'border-zinc-800');
                        });
                        e.target.classList.remove('text-zinc-500', 'border-zinc-800');
                        e.target.classList.add('bg-emerald-500/10', 'text-emerald-400', 'border-emerald-500/30');
                        
                        this.renderPairs();
                    });
                });

                // Mobile Filter buttons
                document.querySelectorAll('.mobile-market-filter-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.currentFilter = e.target.dataset.filter;
                        
                        document.querySelectorAll('.mobile-market-filter-btn').forEach(b => {
                            b.classList.remove('bg-emerald-500/10', 'text-emerald-400', 'border-emerald-500/30');
                            b.classList.add('text-zinc-500', 'border-zinc-800');
                        });
                        e.target.classList.remove('text-zinc-500', 'border-zinc-800');
                        e.target.classList.add('bg-emerald-500/10', 'text-emerald-400', 'border-emerald-500/30');
                        
                        this.renderMobilePairs();
                    });
                });
            }

            loadFavorites() {
                const favorites = JSON.parse(localStorage.getItem('tradingFavorites') || '[]');
                this.pairs.forEach(pair => {
                    pair.isFavorite = favorites.includes(pair.symbol);
                });
            }

            saveFavorites() {
                const favorites = this.pairs.filter(p => p.isFavorite).map(p => p.symbol);
                localStorage.setItem('tradingFavorites', JSON.stringify(favorites));
            }

            toggleFavorite(symbol) {
                const pair = this.pairs.find(p => p.symbol === symbol);
                if (pair) {
                    pair.isFavorite = !pair.isFavorite;
                    this.saveFavorites();
                    this.renderPairs();
                    this.renderMobilePairs();
                }
            }

            selectPair(symbol) {
                this.activePair = symbol;
                const pair = this.pairs.find(p => p.symbol === symbol);
                if (pair) {
                    // Update header with selected pair
                    document.getElementById('active-pair-name').textContent = symbol;
                    document.getElementById('current-price').textContent = `$${pair.price.toLocaleString()}`;
                    
                    const priceChangeValue = (pair.price * pair.change24h / 100);
                    document.getElementById('price-change').textContent = `${pair.change24h >= 0 ? '+' : ''}$${Math.abs(priceChangeValue).toFixed(2)}`;
                    document.getElementById('price-change-percent').textContent = `${pair.change24h >= 0 ? '+' : ''}${pair.change24h.toFixed(2)}%`;
                    
                    // Update colors based on positive/negative change
                    const colorClass = pair.change24h >= 0 ? 'text-emerald-400' : 'text-red-400';
                    document.getElementById('current-price').className = `text-base md:text-xl font-bold ${colorClass}`;
                    document.getElementById('price-change').className = `${colorClass} text-[10px] md:text-xs`;
                    document.getElementById('price-change-percent').className = `${colorClass} text-[10px] md:text-xs`;
                    
                    // Update 24h stats
                    const high = pair.price * 1.05;
                    const low = pair.price * 0.95;
                    
                    // Desktop stats
                    const high24h = document.getElementById('high-24h');
                    const low24h = document.getElementById('low-24h');
                    const volume24h = document.getElementById('volume-24h');
                    
                    if (high24h) high24h.textContent = `$${high.toFixed(2)}`;
                    if (low24h) low24h.textContent = `$${low.toFixed(2)}`;
                    if (volume24h) volume24h.textContent = `$${(pair.volume / 1000000000).toFixed(2)}B`;
                    
                    // Mobile stats
                    const mobileHigh24h = document.getElementById('mobile-high-24h');
                    const mobileLow24h = document.getElementById('mobile-low-24h');
                    const mobileVolume24h = document.getElementById('mobile-volume-24h');
                    
                    if (mobileHigh24h) mobileHigh24h.textContent = `$${high.toFixed(2)}`;
                    if (mobileLow24h) mobileLow24h.textContent = `$${low.toFixed(2)}`;
                    if (mobileVolume24h) mobileVolume24h.textContent = `$${(pair.volume / 1000000000).toFixed(2)}B`;

                    // Close mobile drawer after selection
                    const mobilePairsDrawer = document.getElementById('mobile-pairs-drawer');
                    const mobilePairsOverlay = document.getElementById('mobile-pairs-overlay');
                    if (mobilePairsDrawer && mobilePairsOverlay) {
                        mobilePairsDrawer.classList.add('-translate-x-full');
                        setTimeout(() => {
                            mobilePairsOverlay.classList.add('hidden');
                        }, 300);
                    }
                }
                
                this.renderPairs();
                this.renderMobilePairs();
            }

            getFilteredPairs() {
                let filtered = this.pairs;

                if (this.searchQuery) {
                    filtered = filtered.filter(pair => 
                        pair.symbol.toLowerCase().includes(this.searchQuery) ||
                        pair.name.toLowerCase().includes(this.searchQuery)
                    );
                }

                switch (this.currentFilter) {
                    case 'favorites':
                        filtered = filtered.filter(pair => pair.isFavorite);
                        break;
                    case 'gainers':
                        filtered = filtered.filter(pair => pair.change24h > 0);
                        filtered.sort((a, b) => b.change24h - a.change24h);
                        break;
                    default:
                        filtered.sort((a, b) => b.volume - a.volume);
                }

                return filtered;
            }

            renderPairs() {
                const container = document.getElementById('trading-pairs-list');
                if (!container) return;

                const filtered = this.getFilteredPairs();

                if (filtered.length === 0) {
                    container.innerHTML = `
                        <div class="px-3 py-8 text-center text-zinc-600 text-xs">
                            No pairs found
                        </div>
                    `;
                    return;
                }

                container.innerHTML = filtered.map(pair => {
                    const isPositive = pair.change24h >= 0;
                    const changeColor = isPositive ? 'text-emerald-400' : 'text-red-400';
                    const bgColor = pair.symbol === this.activePair ? 'bg-zinc-900' : '';
                    
                    return `
                        <div class="trading-pair-item px-3 py-2 hover:bg-zinc-900 cursor-pointer transition-colors ${bgColor}" data-symbol="${pair.symbol}">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-2 flex-1 min-w-0">
                                    <button class="favorite-btn text-xs hover:scale-110 transition-transform" data-symbol="${pair.symbol}">
                                        ${pair.isFavorite ? '‚≠ê' : '‚òÜ'}
                                    </button>
                                    <div class="min-w-0 flex-1">
                                        <div class="text-xs font-semibold truncate">${pair.symbol}</div>
                                        <div class="text-[10px] text-zinc-500 truncate">${pair.name}</div>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <div class="text-xs font-semibold font-mono">$${pair.price < 1 ? pair.price.toFixed(4) : pair.price.toLocaleString()}</div>
                                    <div class="text-[10px] font-semibold ${changeColor}">
                                        ${isPositive ? '‚Üë' : '‚Üì'} ${Math.abs(pair.change24h).toFixed(2)}%
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');

                container.querySelectorAll('.trading-pair-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        if (!e.target.classList.contains('favorite-btn')) {
                            this.selectPair(item.dataset.symbol);
                        }
                    });
                });

                container.querySelectorAll('.favorite-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.toggleFavorite(btn.dataset.symbol);
                    });
                });
            }

            renderMobilePairs() {
                const container = document.getElementById('mobile-trading-pairs-list');
                if (!container) return;

                const filtered = this.getFilteredPairs();

                if (filtered.length === 0) {
                    container.innerHTML = `
                        <div class="px-4 py-8 text-center text-zinc-600 text-sm">
                            No pairs found
                        </div>
                    `;
                    return;
                }

                container.innerHTML = filtered.map(pair => {
                    const isPositive = pair.change24h >= 0;
                    const changeColor = isPositive ? 'text-emerald-400' : 'text-red-400';
                    const bgColor = pair.symbol === this.activePair ? 'bg-zinc-900' : '';
                    
                    return `
                        <div class="mobile-trading-pair-item px-4 py-3 hover:bg-zinc-900 active:bg-zinc-800 cursor-pointer transition-colors ${bgColor}" data-symbol="${pair.symbol}">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3 flex-1 min-w-0">
                                    <button class="mobile-favorite-btn text-base hover:scale-110 transition-transform" data-symbol="${pair.symbol}">
                                        ${pair.isFavorite ? '‚≠ê' : '‚òÜ'}
                                    </button>
                                    <div class="min-w-0 flex-1">
                                        <div class="text-sm font-semibold truncate">${pair.symbol}</div>
                                        <div class="text-xs text-zinc-500 truncate">${pair.name}</div>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <div class="text-sm font-semibold font-mono">$${pair.price < 1 ? pair.price.toFixed(4) : pair.price.toLocaleString()}</div>
                                    <div class="text-xs font-semibold ${changeColor}">
                                        ${isPositive ? '‚Üë' : '‚Üì'} ${Math.abs(pair.change24h).toFixed(2)}%
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');

                container.querySelectorAll('.mobile-trading-pair-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        if (!e.target.classList.contains('mobile-favorite-btn')) {
                            this.selectPair(item.dataset.symbol);
                        }
                    });
                });

                container.querySelectorAll('.mobile-favorite-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.toggleFavorite(btn.dataset.symbol);
                    });
                });
            }
        }

        // Trading Chart Implementation
        class TradingChart {
            constructor(canvasId) {
                this.canvas = document.getElementById(canvasId);
                this.ctx = this.canvas.getContext('2d');
                this.data = [];
                this.visibleData = [];
                this.indicators = {
                    ma7: [],
                    ma25: [],
                    ma99: []
                };
                this.offset = 0;
                this.candleWidth = 8;
                this.candleSpacing = 2;
                this.chartPadding = { top: 20, right: 80, bottom: 80, left: 60 };
                this.volumeHeight = 60;
                this.priceRange = { min: 0, max: 0 };
                this.volumeMax = 0;
                this.crosshair = { x: null, y: null };
                
                this.initCanvas();
                this.generateDummyData();
                this.calculateIndicators();
                this.setupEventListeners();
                this.draw();
            }

            initCanvas() {
                const rect = this.canvas.getBoundingClientRect();
                this.canvas.width = rect.width * window.devicePixelRatio;
                this.canvas.height = rect.height * window.devicePixelRatio;
                this.ctx.scale(window.devicePixelRatio, window.devicePixelRatio);
                this.width = rect.width;
                this.height = rect.height;

                // Adjust padding for mobile
                if (window.innerWidth < 768) {
                    this.chartPadding = { top: 15, right: 60, bottom: 60, left: 45 };
                    this.volumeHeight = 40;
                    this.candleWidth = 6;
                }
            }

            generateDummyData() {
                const now = Date.now();
                const oneHour = 3600000;
                let basePrice = 43000;
                
                for (let i = 99; i >= 0; i--) {
                    const time = now - (i * oneHour);
                    const volatility = 100 + Math.random() * 200;
                    
                    const trend = Math.sin(i / 10) * 50;
                    basePrice += (Math.random() - 0.48) * volatility + trend;
                    
                    const open = basePrice;
                    const high = open + Math.random() * volatility;
                    const low = open - Math.random() * volatility;
                    const close = low + Math.random() * (high - low);
                    const volume = 100000000 + Math.random() * 200000000;
                    
                    this.data.push({
                        time,
                        open,
                        high,
                        low,
                        close,
                        volume
                    });
                }

                const lastCandle = this.data[this.data.length - 1];
                const firstCandle = this.data[0];
                const priceChange = lastCandle.close - firstCandle.open;
                const priceChangePercent = (priceChange / firstCandle.open * 100).toFixed(2);
                
                const high24h = Math.max(...this.data.map(d => d.high));
                const low24h = Math.min(...this.data.map(d => d.low));
                const volume24h = this.data.reduce((sum, d) => sum + d.volume, 0);

                document.getElementById('current-price').textContent = `$${lastCandle.close.toFixed(2)}`;
                document.getElementById('current-price').className = `text-base md:text-xl font-bold ${priceChange >= 0 ? 'text-emerald-400' : 'text-red-400'}`;
                document.getElementById('price-change').textContent = `${priceChange >= 0 ? '+' : ''}$${Math.abs(priceChange).toFixed(2)}`;
                document.getElementById('price-change').className = `text-[10px] md:text-xs ${priceChange >= 0 ? 'text-emerald-400' : 'text-red-400'}`;
                document.getElementById('price-change-percent').textContent = `${priceChange >= 0 ? '+' : ''}${priceChangePercent}%`;
                document.getElementById('price-change-percent').className = `text-[10px] md:text-xs ${priceChange >= 0 ? 'text-emerald-400' : 'text-red-400'}`;
                
                const high24hEl = document.getElementById('high-24h');
                const low24hEl = document.getElementById('low-24h');
                const volume24hEl = document.getElementById('volume-24h');
                
                if (high24hEl) high24hEl.textContent = `$${high24h.toFixed(2)}`;
                if (low24hEl) low24hEl.textContent = `$${low24h.toFixed(2)}`;
                if (volume24hEl) volume24hEl.textContent = `$${(volume24h / 1000000000).toFixed(2)}B`;

                const mobileHigh24hEl = document.getElementById('mobile-high-24h');
                const mobileLow24hEl = document.getElementById('mobile-low-24h');
                const mobileVolume24hEl = document.getElementById('mobile-volume-24h');
                
                if (mobileHigh24hEl) mobileHigh24hEl.textContent = `$${high24h.toFixed(2)}`;
                if (mobileLow24hEl) mobileLow24hEl.textContent = `$${low24h.toFixed(2)}`;
                if (mobileVolume24hEl) mobileVolume24hEl.textContent = `$${(volume24h / 1000000000).toFixed(2)}B`;
            }

            calculateIndicators() {
                const periods = [7, 25, 99];
                periods.forEach(period => {
                    const ma = [];
                    for (let i = 0; i < this.data.length; i++) {
                        if (i < period - 1) {
                            ma.push(null);
                        } else {
                            let sum = 0;
                            for (let j = 0; j < period; j++) {
                                sum += this.data[i - j].close;
                            }
                            ma.push(sum / period);
                        }
                    }
                    this[`ma${period}`] = ma;
                    this.indicators[`ma${period}`] = ma;
                });
            }

            setupEventListeners() {
                // Mouse/Touch events for crosshair
                const handleMove = (e) => {
                    const rect = this.canvas.getBoundingClientRect();
                    const clientX = e.clientX || (e.touches && e.touches[0].clientX);
                    const clientY = e.clientY || (e.touches && e.touches[0].clientY);
                    
                    if (clientX && clientY) {
                        this.crosshair.x = clientX - rect.left;
                        this.crosshair.y = clientY - rect.top;
                        this.draw();
                        this.updateTooltip(clientX, clientY, rect);
                    }
                };

                this.canvas.addEventListener('mousemove', handleMove);
                this.canvas.addEventListener('touchmove', (e) => {
                    e.preventDefault();
                    handleMove(e);
                });

                const handleEnd = () => {
                    this.crosshair.x = null;
                    this.crosshair.y = null;
                    document.getElementById('chart-tooltip').classList.add('hidden');
                    this.draw();
                };

                this.canvas.addEventListener('mouseleave', handleEnd);
                this.canvas.addEventListener('touchend', handleEnd);

                // Pinch zoom for mobile
                let lastDistance = 0;
                this.canvas.addEventListener('touchstart', (e) => {
                    if (e.touches.length === 2) {
                        const dx = e.touches[0].clientX - e.touches[1].clientX;
                        const dy = e.touches[0].clientY - e.touches[1].clientY;
                        lastDistance = Math.sqrt(dx * dx + dy * dy);
                    }
                });

                this.canvas.addEventListener('touchmove', (e) => {
                    if (e.touches.length === 2) {
                        e.preventDefault();
                        const dx = e.touches[0].clientX - e.touches[1].clientX;
                        const dy = e.touches[0].clientY - e.touches[1].clientY;
                        const distance = Math.sqrt(dx * dx + dy * dy);
                        
                        if (lastDistance > 0) {
                            const delta = distance > lastDistance ? 1 : -1;
                            this.candleWidth = Math.max(4, Math.min(20, this.candleWidth + delta));
                            this.draw();
                        }
                        
                        lastDistance = distance;
                    }
                });

                this.canvas.addEventListener('wheel', (e) => {
                    e.preventDefault();
                    const delta = e.deltaY > 0 ? 1 : -1;
                    this.candleWidth = Math.max(4, Math.min(20, this.candleWidth + delta));
                    this.draw();
                });

                window.addEventListener('resize', () => {
                    this.initCanvas();
                    this.draw();
                });
            }

            updateTooltip(clientX, clientY, rect) {
                const x = clientX - rect.left;
                const chartWidth = this.width - this.chartPadding.left - this.chartPadding.right;
                const candleFullWidth = this.candleWidth + this.candleSpacing;
                const maxVisible = Math.floor(chartWidth / candleFullWidth);
                const startIndex = Math.max(0, this.data.length - maxVisible - this.offset);
                const index = Math.floor((x - this.chartPadding.left) / candleFullWidth) + startIndex;

                if (index >= 0 && index < this.data.length) {
                    const candle = this.data[index];
                    const tooltip = document.getElementById('chart-tooltip');
                    
                    document.getElementById('tooltip-time').textContent = new Date(candle.time).toLocaleString();
                    document.getElementById('tooltip-open').textContent = candle.open.toFixed(2);
                    document.getElementById('tooltip-high').textContent = candle.high.toFixed(2);
                    document.getElementById('tooltip-low').textContent = candle.low.toFixed(2);
                    document.getElementById('tooltip-close').textContent = candle.close.toFixed(2);
                    document.getElementById('tooltip-volume').textContent = (candle.volume / 1000000).toFixed(2) + 'M';
                    
                    tooltip.style.left = Math.min(clientX + 15, rect.width - 200) + 'px';
                    tooltip.style.top = Math.min(clientY + 15, rect.height - 150) + 'px';
                    tooltip.classList.remove('hidden');
                }
            }

            draw() {
                // Clear canvas
                this.ctx.fillStyle = '#09090b';
                this.ctx.fillRect(0, 0, this.width, this.height);

                // Calculate visible data range
                const chartWidth = this.width - this.chartPadding.left - this.chartPadding.right;
                const candleFullWidth = this.candleWidth + this.candleSpacing;
                const maxVisible = Math.floor(chartWidth / candleFullWidth);
                const startIndex = Math.max(0, this.data.length - maxVisible - this.offset);
                const endIndex = Math.min(this.data.length, startIndex + maxVisible);
                this.visibleData = this.data.slice(startIndex, endIndex);

                // Calculate price range
                this.priceRange.min = Math.min(...this.visibleData.map(d => d.low));
                this.priceRange.max = Math.max(...this.visibleData.map(d => d.high));
                this.volumeMax = Math.max(...this.visibleData.map(d => d.volume));

                // Add padding to price range
                const pricePadding = (this.priceRange.max - this.priceRange.min) * 0.1;
                this.priceRange.min -= pricePadding;
                this.priceRange.max += pricePadding;

                // Draw grid
                this.drawGrid();

                // Draw volume bars
                this.drawVolume(startIndex);

                // Draw indicators
                this.drawIndicators(startIndex);

                // Draw candlesticks
                this.drawCandlesticks();

                // Draw crosshair
                if (this.crosshair.x !== null && this.crosshair.y !== null) {
                    this.drawCrosshair();
                }

                // Draw price axis
                this.drawPriceAxis();
            }

            drawGrid() {
                const chartHeight = this.height - this.chartPadding.top - this.chartPadding.bottom - this.volumeHeight;
                const gridLines = 8;

                this.ctx.strokeStyle = '#27272a';
                this.ctx.lineWidth = 1;

                for (let i = 0; i <= gridLines; i++) {
                    const y = this.chartPadding.top + (chartHeight / gridLines) * i;
                    this.ctx.beginPath();
                    this.ctx.moveTo(this.chartPadding.left, y);
                    this.ctx.lineTo(this.width - this.chartPadding.right, y);
                    this.ctx.stroke();
                }
            }

            drawCandlesticks() {
                const chartHeight = this.height - this.chartPadding.top - this.chartPadding.bottom - this.volumeHeight;
                
                this.visibleData.forEach((candle, i) => {
                    const x = this.chartPadding.left + i * (this.candleWidth + this.candleSpacing);
                    const openY = this.chartPadding.top + (1 - (candle.open - this.priceRange.min) / (this.priceRange.max - this.priceRange.min)) * chartHeight;
                    const closeY = this.chartPadding.top + (1 - (candle.close - this.priceRange.min) / (this.priceRange.max - this.priceRange.min)) * chartHeight;
                    const highY = this.chartPadding.top + (1 - (candle.high - this.priceRange.min) / (this.priceRange.max - this.priceRange.min)) * chartHeight;
                    const lowY = this.chartPadding.top + (1 - (candle.low - this.priceRange.min) / (this.priceRange.max - this.priceRange.min)) * chartHeight;

                    const isGreen = candle.close >= candle.open;
                    const color = isGreen ? '#10b981' : '#ef4444';

                    // Draw wick
                    this.ctx.strokeStyle = color;
                    this.ctx.lineWidth = 1;
                    this.ctx.beginPath();
                    this.ctx.moveTo(x + this.candleWidth / 2, highY);
                    this.ctx.lineTo(x + this.candleWidth / 2, lowY);
                    this.ctx.stroke();

                    // Draw body
                    this.ctx.fillStyle = color;
                    const bodyHeight = Math.abs(closeY - openY);
                    const bodyY = Math.min(openY, closeY);
                    this.ctx.fillRect(x, bodyY, this.candleWidth, Math.max(1, bodyHeight));
                });
            }

            drawVolume(startIndex) {
                const volumeY = this.height - this.chartPadding.bottom;
                
                this.visibleData.forEach((candle, i) => {
                    const x = this.chartPadding.left + i * (this.candleWidth + this.candleSpacing);
                    const volumeRatio = candle.volume / this.volumeMax;
                    const barHeight = volumeRatio * this.volumeHeight;
                    const isGreen = candle.close >= candle.open;
                    
                    this.ctx.fillStyle = isGreen ? 'rgba(16, 185, 129, 0.3)' : 'rgba(239, 68, 68, 0.3)';
                    this.ctx.fillRect(x, volumeY - barHeight, this.candleWidth, barHeight);
                });
            }

            drawIndicators(startIndex) {
                const chartHeight = this.height - this.chartPadding.top - this.chartPadding.bottom - this.volumeHeight;
                const indicators = [
                    { data: this.ma7, color: '#3b82f6', name: 'MA7' },
                    { data: this.ma25, color: '#f59e0b', name: 'MA25' },
                    { data: this.ma99, color: '#8b5cf6', name: 'MA99' }
                ];

                indicators.forEach(indicator => {
                    this.ctx.strokeStyle = indicator.color;
                    this.ctx.lineWidth = 1.5;
                    this.ctx.beginPath();

                    let firstPoint = true;
                    this.visibleData.forEach((candle, i) => {
                        const globalIndex = startIndex + i;
                        const maValue = indicator.data[globalIndex];
                        
                        if (maValue !== null && maValue !== undefined) {
                            const x = this.chartPadding.left + i * (this.candleWidth + this.candleSpacing) + this.candleWidth / 2;
                            const y = this.chartPadding.top + (1 - (maValue - this.priceRange.min) / (this.priceRange.max - this.priceRange.min)) * chartHeight;
                            
                            if (firstPoint) {
                                this.ctx.moveTo(x, y);
                                firstPoint = false;
                            } else {
                                this.ctx.lineTo(x, y);
                            }
                        }
                    });

                    this.ctx.stroke();
                });
            }

            drawPriceAxis() {
                const chartHeight = this.height - this.chartPadding.top - this.chartPadding.bottom - this.volumeHeight;
                const priceSteps = 8;

                this.ctx.fillStyle = '#71717a';
                this.ctx.font = window.innerWidth < 768 ? '9px monospace' : '10px monospace';
                this.ctx.textAlign = 'left';

                for (let i = 0; i <= priceSteps; i++) {
                    const price = this.priceRange.min + (this.priceRange.max - this.priceRange.min) * (i / priceSteps);
                    const y = this.chartPadding.top + chartHeight - (chartHeight / priceSteps) * i;
                    this.ctx.fillText('$' + price.toFixed(0), this.width - this.chartPadding.right + 5, y + 3);
                }
            }

            drawCrosshair() {
                this.ctx.strokeStyle = '#52525b';
                this.ctx.lineWidth = 1;
                this.ctx.setLineDash([4, 4]);

                // Vertical line
                this.ctx.beginPath();
                this.ctx.moveTo(this.crosshair.x, this.chartPadding.top);
                this.ctx.lineTo(this.crosshair.x, this.height - this.chartPadding.bottom);
                this.ctx.stroke();

                // Horizontal line
                this.ctx.beginPath();
                this.ctx.moveTo(this.chartPadding.left, this.crosshair.y);
                this.ctx.lineTo(this.width - this.chartPadding.right, this.crosshair.y);
                this.ctx.stroke();

                this.ctx.setLineDash([]);
            }
        }

        // Initialize everything when DOM is loaded
        window.addEventListener('DOMContentLoaded', () => {
            const pairsManager = new TradingPairsManager();
            const chart = new TradingChart('trading-chart');

            // Initialize mobile components
            initMobileTabs();
            initMobilePairsDrawer();
            renderOrderBook();

            // Desktop Timeframe buttons
            document.querySelectorAll('.timeframe-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.timeframe-btn').forEach(b => {
                        b.classList.remove('border-emerald-500', 'bg-emerald-500/10', 'text-emerald-400', 'active');
                        b.classList.add('border-zinc-800');
                    });
                    btn.classList.remove('border-zinc-800');
                    btn.classList.add('border-emerald-500', 'bg-emerald-500/10', 'text-emerald-400', 'active');
                });
            });

            // Mobile Timeframe buttons
            document.querySelectorAll('.mobile-timeframe-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.mobile-timeframe-btn').forEach(b => {
                        b.classList.remove('border-emerald-500', 'bg-emerald-500/10', 'text-emerald-400', 'active');
                        b.classList.add('border-zinc-800');
                    });
                    btn.classList.remove('border-zinc-800');
                    btn.classList.add('border-emerald-500', 'bg-emerald-500/10', 'text-emerald-400', 'active');
                });
            });
        });
    </script>
</body>
</html>